{% schema %}
{
  "name": "Customizable ",
  "settings": [],
  "blocks": [
    {
      "type": "tab",
      "name": "Tab",
      "settings": [
        {
          "type": "text",
          "id": "tab_label",
          "label": "Tab Label",
          "default": "Q1"
        },
        {
          "type": "textarea",
          "id": "announcements_json",
          "label": "Announcements (JSON format)",
          "default": "[{\"year\":\"2024-25\",\"title\":\"TRADING WINDOW CLOSURE Q4 FY25\",\"view_link\":\"#\",\"download_link\":\"#\"}]"
        }
      ]
    }
  ],
  "max_blocks": 10,
  "presets": [
    {
      "name": "Tabs with Multiple Details"
    }
  ]
}
{% endschema %}

<div class="custom-tabs">
  <ul class="tab-nav">
    {% for block in section.blocks %}
      <li class="{% if forloop.first %}active{% endif %}" data-tab="tab-{{ block.id }}">{{ block.settings.tab_label }}</li>
    {% endfor %}
  </ul>

  <div class="tab-content">
    {% for block in section.blocks %}
      <div class="tab-pane {% if forloop.first %}active{% endif %}" id="tab-{{ block.id }}">
        {% assign announcements = block.settings.announcements_json | parse_json %}
        {% for announcement in announcements %}
          <div class="announcement-item">
            <div class="year">{{ announcement.year }}</div>
            <div class="title">{{ announcement.title }}</div>
            <div class="icons">
              {% if announcement.view_link %}
                <a href="{{ announcement.view_link }}" class="view" target="_blank">
                  <img src="{{ 'eye-icon.svg' | asset_url }}" alt="View">
                </a>
              {% endif %}
              {% if announcement.download_link %}
                <a href="{{ announcement.download_link }}" class="download" target="_blank">
                  <img src="{{ 'download-icon.svg' | asset_url }}" alt="Download">
                </a>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% endfor %}
  </div>
</div>

<style>
.custom-tabs {
  font-family: Arial, sans-serif;
  max-width: 700px;
  margin: 20px auto;
}

.tab-nav {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.tab-nav li {
  list-style: none;
  padding: 8px 16px;
  border: 1px solid #ccc;
  border-radius: 20px;
  cursor: pointer;
}

.tab-nav li.active {
  background-color: #007bff;
  color: #fff;
  border-color: #007bff;
}

.tab-content .tab-pane {
  display: none;
}

.tab-content .tab-pane.active {
  display: block;
}

.announcement-item {
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 15px;
  background-color: #f9f9f9;
  margin-bottom: 10px;
}

.year {
  font-weight: bold;
  margin-bottom: 5px;
}

.title {
  font-size: 1.1em;
  margin-bottom: 10px;
}

.icons {
  display: flex;
  gap: 10px;
}

.icons a img {
  width: 24px;
  height: 24px;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const tabs = document.querySelectorAll('.tab-nav li');
  const panes = document.querySelectorAll('.tab-pane');

  tabs.forEach(tab => {
    tab.addEventListener('click', function() {
      tabs.forEach(t => t.classList.remove('active'));
      panes.forEach(p => p.classList.remove('active'));

      tab.classList.add('active');
      const pane = document.getElementById(tab.dataset.tab);
      if (pane) pane.classList.add('active');
    });
  });
});
</script>
