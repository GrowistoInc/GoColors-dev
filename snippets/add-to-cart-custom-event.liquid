document.addEventListener('DOMContentLoaded', function () {
  const add_to_cart = document.querySelector('.product-form');

  if (add_to_cart) {
      add_to_cart.addEventListener('click', function () {
         fetch('/cart.js')
            .then(res => res.json())
            .then(cart => {
              const lastItem = cart.items[cart.items.length - 1];
              if (!lastItem) return;

              const ga4Item = {
                item_id: lastItem.product_id.toString(),
                item_name: lastItem.title,
                item_brand: lastItem.vendor || "",
                item_category: lastItem.product_type || "",
                item_variant: lastItem.variant_title || "",
                price: lastItem.price / 100,
                quantity: lastItem.quantity,
                affiliation: "Online Store"
              };
              window.dataLayer = window.dataLayer || [];
              window.dataLayer.push({
                event: 'add_to_cart',
                item: ga4Item
              });
            
              console.log("GA4 Event Sent: add_to_cart");
       });
    }
// Add to Cart Event
}); 