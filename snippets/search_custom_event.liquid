<script>
(function () {

  let lastSearchTerm = null;

  document.addEventListener('submit', function (e) {

    const form = e.target;

    // Only search forms
    if (!form || !form.action || !form.action.includes('/search')) return;

    const input =
      form.querySelector('input[name="q"]') ||
      form.querySelector('input[name="query"]') ||
      form.querySelector('input[name="_ss"]');

    if (!input) return;

    const searchTerm = input.value.trim();
    if (!searchTerm || searchTerm === lastSearchTerm) return;

    lastSearchTerm = searchTerm;

    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
      event: 'search',
      search_term: searchTerm
    });

    console.log('âœ… GA4 search fired (ENTER submit)', searchTerm);

  });

})();
</script>
